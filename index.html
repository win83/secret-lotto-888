<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•¸æ“šåŠ è¼‰ä¸­...</title>
    <style>
        /* ä»¿æˆªåœ–é¢¨æ ¼çš„è—è‰²èª¿è¨­è¨ˆ */
        :root {
            --header-blue: #335495;
            --bg-gray: #f0f2f5;
            --lotto-red: #ff0000;
        }
        body { font-family: "Microsoft JhengHei", Arial, sans-serif; background: var(--bg-gray); margin: 0; padding: 15px; display: flex; justify-content: center; }
        .container { width: 100%; max-width: 1000px; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); display: none; }
        
        h2 { text-align: center; color: var(--header-blue); border-bottom: 2px solid var(--header-blue); padding-bottom: 10px; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 15px; }
        th { background-color: var(--header-blue); color: white; padding: 12px; border: 1px solid #ccc; }
        td { padding: 10px; border: 1px solid #ddd; text-align: center; color: #333; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        tr:hover { background-color: #f1f4f9; }

        /* è™Ÿç¢¼çƒæ¨£å¼ */
        .ball { 
            display: inline-block; width: 28px; height: 28px; line-height: 28px; 
            background: var(--lotto-red); color: white; border-radius: 50%; 
            font-weight: bold; margin: 2px; box-shadow: 1px 1px 3px rgba(0,0,0,0.2); 
        }
        .update-tag { text-align: right; color: #888; font-size: 12px; margin-top: 10px; }
    </style>
</head>
<body>

<div id="main-content" class="container">
    <h2>ä»Šå½©539é–‹çè™Ÿç¢¼ (å³æ™‚åŒæ­¥)</h2>
    <div id="table-output">è³‡æ–™è®€å–ä¸­...</div>
    <div id="update-time" class="update-tag"></div>
</div>

<script>
    // ================== è¨­å®šå€ ==================
    const MY_PASSWORD = "888"; // æ‚¨çš„å¯†ç¢¼
    const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vR8WrWE0iixFvYvLGrWw8u5tBUajra0M1Uyz3AElqqLxfClEuXuEx71uQjmJU88zw/pub?output=csv'; 
    // ===========================================

    function auth() {
        // æª¢æŸ¥æ­¤ç€è¦½éšæ®µæ˜¯å¦å·²é©—è­‰é
        if (sessionStorage.getItem('isVerified') === 'true') {
            showContent();
            return;
        }

        // ä¿®æ”¹å¾Œçš„æç¤ºæ–‡å­—
        const pass = prompt("è¼¸å…¥å¯†ç¢¼");
        
        if (pass === MY_PASSWORD) {
            sessionStorage.setItem('isVerified', 'true');
            showContent();
        } else if (pass !== null) {
            alert("å¯†ç¢¼éŒ¯èª¤");
            document.body.innerHTML = "<h2 style='text-align:center;margin-top:100px;'>ğŸ”’ å­˜å–å—é™ï¼Œè«‹åˆ·æ–°é é¢é‡æ–°è¼¸å…¥</h2>";
        }
    }

    function showContent() {
        document.getElementById('main-content').style.display = 'block';
        document.title = "539æ•¸æ“šçœ‹æ¿";
        loadData();
    }

    async function loadData() {
        try {
            // fetch åŠ ä¸Šæ™‚é–“æˆ³ï¼Œç¢ºä¿æ¯æ¬¡æŠ“å–éƒ½æ˜¯æœ€æ–°çš„ Google Sheets è³‡æ–™
            const response = await fetch(`${CSV_URL}&t=${new Date().getTime()}`);
            const csvText = await response.text();
            renderTable(csvText);
            document.getElementById('update-time').innerText = "æœ€å¾Œæ›´æ–°æ—¥æœŸï¼š" + new Date().toLocaleString();
        } catch (err) {
            document.getElementById('table-output').innerHTML = "è³‡æ–™é€£ç·šå¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯æˆ– Google Sheets ç™¼ä½ˆç‹€æ…‹ã€‚";
        }
    }

    function renderTable(csv) {
        // ä¾æ“šæ›è¡Œç¬¦è™Ÿåˆ‡å‰²ï¼Œä¸¦éæ¿¾æ‰ç©ºç™½è¡Œ
        const lines = csv.split(/\r?\n/).filter(l => l.trim() !== "");
        if (lines.length === 0) return;

        let html = '<table><thead><tr>';
        const headers = lines[0].split(',');
        headers.forEach(h => html += `<th>${h}</th>`);
        html += '</tr></thead><tbody>';

        for (let i = 1; i < lines.length; i++) {
            const cells = lines[i].split(',');
            html += '<tr>';
            cells.forEach((cell, index) => {
                const cleanCell = cell.replace(/^"(.*)"$/, '$1').trim(); // å»é™¤ Excel å¯èƒ½å¸¶æœ‰çš„å¼•è™Ÿ
                
                // é‚è¼¯ï¼šå¦‚æœæ¬„ä½å…§å®¹çœ‹èµ·ä¾†æ˜¯å¤šå€‹è™Ÿç¢¼ï¼ˆå¦‚ 05 12 16...ï¼‰
                if (index > 0 && /[\d]{2}/.test(cleanCell)) {
                    const nums = cleanCell.split(/[\s,]+/);
                    const balls = nums.map(n => `<span class="ball">${n}</span>`).join('');
                    html += `<td>${balls}</td>`;
                } else {
                    html += `<td>${cleanCell}</td>`;
                }
            });
            html += '</tr>';
        }
        html += '</tbody></table>';
        document.getElementById('table-output').innerHTML = html;
    }

    // å•Ÿå‹•ç¨‹åº
    auth();
</script>
</body>
</html>
